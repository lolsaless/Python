# Streamlit을 이용한 배포용 실적조회 프로그램 만들기

Streamlit을 사용하여 실내공기질 Excel 데이터를 처리하는 웹 앱을 만들어주세요. 다음과 같은 기능이 단계별로 포함되어야 합니다:

---

📂 0. 기본 설정

- Streamlit 앱의 제목은 "📊 실내공기질 데이터 처리 앱 (1~6단계)"
- 레이아웃은 `wide`, 페이지 타이틀은 앱 제목과 동일하게 설정
- 두 개의 엑셀 파일을 업로드 받음:
  - 실험노트 파일
  - 조회통계 파일

---

🔢 1단계: 병합

- 두 엑셀 파일을 `접수번호` 기준으로 inner merge
- 병합 결과를 Excel로 변환하여 다운로드 버튼 제공
- 데이터프레임 미리보기 포함 (`st.dataframe()`)

---

🔎 2단계: 실내공기질 필터링

- `검체유형_x` 열에서 `'실내공기질'` 포함된 행만 필터링
- 결과 다운로드 버튼 및 미리보기 제공

---

🧮 3단계: 변수 추출 및 재구성

- `검체유형_x`에서 `'시설군'` 컬럼을 `/` 기준으로 세 번째 항목 추출
- 다음 열만 추출해 새 DataFrame 생성:  
  `['의뢰기관', '시설군', '배출시설', '시설명', '채취장소_x', '시료명_x', 'PM10', 'PM2.5', 'CO2', '폼알데하이드', '부유세균', '일산화탄소', '라돈', '라돈(밀폐)', '벤젠', '톨루엔', '에틸벤젠', '자일렌', '스틸렌', '부적합항목', '확인일', '검사결과', '접수번호', '접수일자']`
- 이후 공통 전처리:
  - 열 이름 변경 (`의뢰기관` → `시군명` 등)
  - `접수번호_10자리` 파생 컬럼 생성
  - 시설명 기준 `시료명` 값들을 합쳐 `채취지점` 열 생성

---

🏢 4단계: 기존/신축공동주택 필터링

- `시설군` 값이 `'기존공동주택'` 또는 `'신축공동주택'`인 행만 추출
- 결과 다운로드 및 미리보기 제공

---

🏬 5단계: 다중이용시설 처리

- '불검출' 값을 `None`으로 치환 후 수치형으로 변환
- 특정 항목(PM10, CO2 등)에 대해 `시설명 + 접수번호_10자리` 그룹 평균 계산
- 원본 행에서 수치형 열 제거 및 고유 조합 병합
- 검사결과가 '적합'이면 `부적합항목`은 빈 문자열 처리
- 기존/신축공동주택을 제외한 나머지를 다중이용시설로 분류
- 결과 다운로드 및 미리보기 제공

---

🧷 6단계: 최종 통합 및 저장

- `apart_df`, `multi_df`에서 `확인일`을 날짜형으로 변환 후 정렬
- `multi_df`에서는 `접수번호` 열 제거
- 두 데이터프레임을 각각 다른 시트에 넣은 Excel 파일 생성
  - 시트명은 `다중이용시설`, `기존신축공동주택`
  - 글자크기 10pt, 열너비 11로 통일
- 다운로드 버튼으로 `.xlsx` 파일 제공

---

📌 추가 조건:

- 각 단계마다 다운로드 버튼 제공 (Streamlit의 `st.download_button`)
- 예외 발생 시 Streamlit의 `st.info()` 또는 `st.warning()`을 활용
- 전반적인 사용자 흐름을 직관적으로 만들 것

