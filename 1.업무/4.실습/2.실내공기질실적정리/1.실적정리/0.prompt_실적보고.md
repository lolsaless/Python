# Excel 데이터 분석 자동화용 프롬프트 작성법
## 1. 데이터 병합 추출
다음과 같은 작업을 수행하는 Python 코드를 작성해 주세요. 모든 작업은 pandas 라이브러리를 사용하며, Excel 통합 문서를 기준으로 처리합니다.

1. 두 개의 Excel 파일을 불러옵니다.
   - 첫 번째 파일은 '실험노트.xlsx'이고, 두 번째 파일은 '조회통계.xlsx'입니다.
   - 두 파일은 모두 동일한 형식의 일반적인 엑셀 파일이며, 기본 시트에 데이터가 있습니다.

2. 두 파일을 '접수번호' 열을 기준으로 **inner 방식으로 병합**합니다.

3. 병합된 결과를 '1.병합 데이터.xlsx'라는 이름의 새 Excel 파일로 저장합니다.

4. 병합된 데이터 중에서 `'검체유형_x'` 열에 `'실내공기질'`이라는 문자열이 포함된 행만 필터링합니다.
   - 이 필터링된 결과를 '2.실내공기질 필터링 데이터.xlsx'로 저장합니다.

5. 필터링된 데이터에 새 열 `'시설군'`을 추가합니다.
   - '검체유형_x' 열의 값을 `'/'`로 분리한 뒤, **세 번째 항목(인덱스 2)**을 추출하여 '시설군'으로 저장합니다.

6. 다음 열만 포함된 새 DataFrame을 생성해 주세요.
['의뢰기관', '시설군', '배출시설', '시설명', '채취장소_x', '시료명_x', 'PM10', 'PM2.5', 'CO2', '폼알데하이드', '부유세균', '일산화탄소', '라돈', '라돈(밀폐)', '벤젠', '톨루엔', '에틸벤젠', '자일렌', '스틸렌', '부적합항목', '확인일', '검사결과', '접수번호', '접수일자']


7. 위 열만 포함된 데이터를 '3.추출 데이터.xlsx'라는 이름의 Excel 파일로 저장해 주세요.

8. 각 주요 단계(필터링, 열 추출 등) 후에는 `head()` 함수를 통해 상위 데이터를 출력해서 처리된 내용을 확인할 수 있도록 해 주세요.

## 2. 기존 신축 공동주택
pandas를 사용해서 다음 작업을 수행하는 Python 코드를 작성해 주세요:

1. **Excel 파일 로드**
   - 파일명은 `'3.추출 데이터.xlsx'`이고, 첫 번째 시트(`'Sheet1'`)에서 데이터를 읽어옵니다.

2. **열 이름 변경**
   아래와 같은 매핑 기준으로 컬럼명을 변경해 주세요:
'의뢰기관' → '시군명'
'배출시설' → '세부시설군'
'채취장소_x' → '주소'
'PM10' → '미세먼지(PM10)'
'PM2.5' → '초미세먼지(PM2.5)'
'CO2' → '이산화탄소'
'부유세균' → '총부유세균'
'시료명_x' → '시료명'


3. **'시설군' 열에서 값이 '기존공동주택' 또는 '신축공동주택'인 행만 필터링**합니다.

4. **열 순서를 재정렬**합니다. 다음 리스트의 순서를 기준으로 열을 재배치하되, 해당 열이 실제 존재하는 경우만 포함해 주세요:
[ '시군명', '시설군', '시설명', '세부시설군', '주소', '시료명', '검사결과', '부적합항목', '접수일자', '확인일', '접수번호_10자리', '접수번호', '채취지점', '미세먼지(PM10)', '초미세먼지(PM2.5)', '이산화탄소', '폼알데하이드', '총부유세균', '일산화탄소', '라돈', '라돈(밀폐)', '벤젠', '톨루엔', '에틸벤젠', '자일렌', '스틸렌' ]


5. **결과 저장**
- 필터링 및 열 재정렬이 완료된 데이터를 `'4.기존신축공동주택 데이터.xlsx'`라는 이름의 새 Excel 파일로 저장합니다.
- 최종 결과는 `print()` 함수를 통해 콘솔에 출력해 주세요.

## 3. 다중이용시설
다음 조건에 맞는 **pandas 기반의 Python 코드**를 작성해 주세요.  
데이터는 `3.추출 데이터.xlsx` 파일에서 불러오며, 전체 처리 흐름은 아래와 같습니다.

1. 📂 Excel 파일 불러오기
- `'3.추출 데이터.xlsx'` 파일을 읽어옵니다.
- 기본 시트(`'Sheet1'`)를 사용하며, 변수명은 `data`로 지정합니다.

2. 🏷️ 열 이름 변경
다음 열 이름을 아래와 같이 변경해 주세요:

| 원래 열 이름     | 변경할 이름           |
|------------------|------------------------|
| 의뢰기관         | 시군명                |
| 배출시설         | 세부시설군            |
| 채취장소_x       | 주소                  |
| PM10             | 미세먼지(PM10)        |
| PM2.5            | 초미세먼지(PM2.5)     |
| CO2              | 이산화탄소            |
| 부유세균         | 총부유세균            |

3. 🔢 텍스트 → 숫자 변환
아래 열들의 값 중 `"불검출"` 텍스트를 `NaN`으로 처리한 뒤, 모두 숫자로 변환합니다.

- `미세먼지(PM10)`
- `초미세먼지(PM2.5)`
- `이산화탄소`
- `폼알데하이드`
- `총부유세균`
- `일산화탄소`
- `라돈`
- `벤젠`
- `톨루엔`
- `에틸벤젠`
- `자일렌`
- `스틸렌`


4. 🔍 접수번호 전처리
- `'접수번호'` 열의 앞 10자리를 잘라 `'접수번호_10자리'`라는 새로운 열을 생성합니다.

5. 📊 평균값 계산
- `'시설명'`과 `'접수번호_10자리'`를 기준으로 위 수치형 열들의 평균을 계산합니다.
- 결과는 `data_avg`라는 새로운 DataFrame으로 저장합니다.

6. 🏷️ 채취지점 정보 생성
- `'시설명'` 기준으로 `'시료명_x'` 고유값들을 쉼표로 연결한 문자열을 `'채취지점'` 열로 생성합니다.

7. 🔗 데이터 병합
- 기존 DataFrame에서 수치형 열을 제거하고, 중복을 제거한 후(`'시설명'`, `'접수번호_10자리'` 기준)
- `data_avg`와 병합하여 `data_merged`를 생성합니다.
- 병합 후 `'시료명_x'` 열이 존재하면 제거합니다.

8. ✅ 검사결과 처리
- `'검사결과'`가 `'적합'`인 경우, `'부적합항목'` 값을 빈 문자열로 설정합니다.

9. 🔍 특정 시설군 제외
- `'시설군'` 값이 `'기존공동주택'`, `'신축공동주택'`인 행은 모두 제외합니다.

10. 📐 열 순서 정리 및 정렬
다음 열 순서대로 정리하고, 존재하는 열만 포함시켜 주세요:
[ '시군명', '시설군', '시설명', '세부시설군', '주소', '검사결과', '부적합항목', '접수일자', '확인일', '접수번호_10자리', '접수번호', '채취지점', '미세먼지(PM10)', '초미세먼지(PM2.5)', '이산화탄소', '폼알데하이드', '총부유세균', '일산화탄소', '라돈', '라돈(밀폐)', '벤젠', '톨루엔', '에틸벤젠', '자일렌', '스틸렌' ]


정렬 기준: ['시군명', '시설군', '세부시설군', '시설명', '주소', '채취지점']

11. 💾 결과 저장
- 최종 정리된 데이터를 `'5.다중이용시설 데이터.xlsx'`라는 파일로 저장합니다.
- 인덱스는 저장하지 않습니다 (`index=False`).

## 4. 통합
다음과 같은 작업을 수행하는 **pandas + openpyxl 기반의 Python 코드**를 작성해 주세요.

---

### 📂 1. 엑셀 파일 불러오기
- 다음 두 개의 Excel 파일을 불러옵니다:
  - `'4.기존신축공동주택 데이터.xlsx'`
  - `'5.다중이용시설 데이터.xlsx'`

---

### 🔢 2. 숫자 데이터 형식 정리
- 다음 열의 데이터에서 숫자로 변환 가능한 값은 숫자(`float`)로 변환하고, 변환 불가능한 값(예: 텍스트)은 원래 값을 유지합니다: ['벤젠', '톨루엔', '에틸벤젠', '자일렌', '스틸렌']

- 변환은 `pd.to_numeric(errors='coerce')`와 `combine_first()`를 함께 사용하여 처리합니다.

---

### 📅 3. 날짜 데이터 정리 및 정렬
- `'확인일'` 열을 `datetime.date` 형식으로 변환하되, 시간 정보는 제거합니다.
- `'확인일'` 기준으로 오름차순 정렬합니다.
- 위 작업은 두 데이터프레임(`df1`, `df2`)에 모두 적용합니다.

---

### 🧹 4. 열 제거
- `다중이용시설 데이터`(`df2`)에서는 `'접수번호'` 열을 제거합니다(존재할 경우만).

---

### 📑 5. 두 시트를 포함하는 하나의 Excel 파일 생성
- `pandas.ExcelWriter`를 사용하여 다음과 같이 저장합니다:
- 시트1: `'다중이용시설'` → `df2` 저장
- 시트2: `'기존신축공동주택'` → `df1` 저장
- 파일 이름은 `'6.통합 데이터.xlsx'`로 지정합니다.

---

### 🖋️ 6. 엑셀 서식 지정 (`openpyxl` 활용)
- 저장한 파일을 `openpyxl`로 다시 불러온 뒤, 각 시트에 대해 다음 서식을 지정합니다:
- 전체 셀의 글꼴 크기를 **10 pt**로 변경
- 모든 열의 너비를 **11**로 고정

---

### 💾 7. 최종 저장 및 확인 메시지
- 파일을 덮어쓰기 저장합니다.
- 마지막에 `"엑셀 파일이 서식과 함께 '6.통합 데이터.xlsx'로 저장되었습니다."` 메시지를 출력합니다.

