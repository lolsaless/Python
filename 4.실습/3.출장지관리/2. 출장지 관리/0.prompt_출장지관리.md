# 출장지관리 프로그램 만들기
다음과 같은 기능을 갖춘 Python 웹 애플리케이션을 Flask + Folium + Tkinter + Pandas 기반으로 작성해주세요.

📁 1. [엑셀 파일 로딩 기능]
- 사용자가 Tkinter 파일 탐색기를 통해 `.xlsx` 또는 `.xls` 엑셀 파일을 선택합니다.
- 선택된 엑셀 파일은 Pandas DataFrame으로 불러오며, 이때 "Latitude", "Longitude", "시설명", "시설군", "주소" 컬럼이 있어야 합니다.
- "완료"라는 열이 없으면 자동으로 추가해주고 빈 문자열로 채워주세요.

📍 2. [Folium 기반 지도 생성]
- 지도 중심 좌표는 엑셀에 있는 위도/경도 평균값으로 설정합니다.
- 각 데이터 행마다 마커를 추가하며, 마커의 색상은 `시설군` 컬럼 값에 따라 다르게 설정해주세요.
  - `facility_colors` 딕셔너리 기반 색상 매핑 포함
  - 단, `완료` 상태인 경우에는 항상 검은색 마커 사용
- 마커 클릭 시 팝업창에 다음 정보가 표시되어야 합니다:
  - 시설명
  - 시설군
  - 주소
  - 두 개의 버튼: `완료`, `취소`

🖱️ 3. [JavaScript 인터랙션]
- 완료/취소 버튼 클릭 시 AJAX 요청으로 `/update` 경로로 `POST`를 보냅니다:
  - `id` (데이터프레임 인덱스), `action` (complete/cancel)
- 서버는 해당 인덱스의 완료 상태를 갱신하고, 원래 엑셀 파일에 덮어써서 저장합니다.

📊 4. [진행상황 요약 패널]
- 우측 상단에 고정된 패널을 HTML로 생성해 지도에 붙입니다.
- `각 시군별 완료 건수 / 전체 건수`를 계산해 보여주고,
- 전체 총 완료 수 / 전체 수 도 함께 표시합니다.

🧨 5. [서버 종료 기능]
- 패널 내 `종료` 버튼을 누르면 `/shutdown` 경로에 GET 요청을 보내 서버가 즉시 종료됩니다.
- 서버 종료는 플랫폼별로 처리:
  - Windows: `taskkill`
  - Unix 계열: `os.kill`

🌐 6. [브라우저 자동 실행]
- `Flask` 앱이 실행되면 `threading.Timer`를 사용하여 1초 후 `http://127.0.0.1:5000`을 자동으로 열어주세요.

📌 7. [기타 요구사항]
- 전체 코드에는 초보자도 이해할 수 있도록 상세한 주석을 작성해주세요.
- 오류가 발생할 경우 사용자에게 알림창(alert)을 통해 메시지를 표시해주세요.
- 웹 인터페이스는 외부 템플릿이 아닌 `render_template_string`을 통해 지도 + HTML + JS를 통합 구성합니다.


## Pyinstaller를 이용하여 배포형 프로그램으로 만들기
cd "C:\Git\excel\3.출장지관리\2. 출장지 관리"
pyinstaller --onefile --noconsole 1.vscode_출장지관리.py